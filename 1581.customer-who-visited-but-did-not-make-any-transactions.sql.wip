--
-- @lc app=leetcode id=1581 lang=postgresql
--
-- [1581] Customer Who Visited but Did Not Make Any Transactions
--

-- @lc code=start
-- Write your PostgreSQL query statement below

SELECT
    customer_id,
    count(customer_id) as count_no_trans
FROM
    Visits v
LEFT JOIN
    Transactions t ON t.visit_id = v.visit_id
WHERE 
    t.visit_id is NULL
GROUP BY
    v.customer_id
;

-- @lc code=end

